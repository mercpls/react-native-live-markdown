{"version":3,"names":["_styleUtils","require","_loadingIndicator","INLINE_IMAGE_PREVIEW_DEBOUNCE_TIME_MS","inlineImageDefaultStyles","position","bottom","left","timeoutMap","Map","getImagePreviewElement","targetElement","Array","from","childNodes","find","el","contentEditable","handleOnLoad","currentInput","target","imageHref","markdownStyle","imageContainer","err","_markdownStyle$inline","isConnected","_getImagePreviewEleme","_getImagePreviewEleme2","currentElement","querySelector","getAttribute","currentElementURL","targetElementURL","currentSpinner","remove","img","firstChild","minHeight","minWidth","maxHeight","maxWidth","borderRadius","inlineImage","imgStyle","Object","assign","style","display","alignItems","justifyContent","appendChild","currentInputElement","imageElements","push","imageClientHeight","Math","max","clientHeight","height","imageMarginTop","parseStringWithUnitToNumber","marginTop","paddingBottom","createImageElement","targetNode","url","has","orderIndex","mapItem","get","clearTimeout","timeout","delete","setTimeout","document","createElement","setAttribute","Image","onload","element","onerror","src","set","updateImageTreeNode","newElement","cloneNode","currentParent","parentElement","includes","addInlineImagePreview","text","ranges","inlineImagesProps","_markdownStyle$inline2","_markdownStyle$inline3","_currentInput$imageEl","_markdownStyle$loadin","_markdownStyle$loadin2","addAuthTokenToImageURLCallback","imagePreviewAuthRequiredURLs","linkRange","r","type","substring","start","length","startsWith","imageMarginBottom","marginBottom","alreadyLoadedPreview","loadedImageContainer","spinner","createLoadingIndicator","loadingIndicatorContainer","loadingIndicator","undefined","forceRefreshAllImages","querySelectorAll","forEach","naturalWidth","imgElement","_img$parentElement"],"sourceRoot":"../../../../src","sources":["web/inputElements/inlineImage.ts"],"mappings":";;;;;;;AAEA,IAAAA,WAAA,GAAAC,OAAA;AAGA,IAAAC,iBAAA,GAAAD,OAAA;AAEA,MAAME,qCAAqC,GAAG,GAAG;AAEjD,MAAMC,wBAAwB,GAAG;EAC/BC,QAAQ,EAAE,UAAU;EACpBC,MAAM,EAAE,CAAC;EACTC,IAAI,EAAE;AACR,CAAC;AAOD,MAAMC,UAAU,GAAG,IAAIC,GAAG,CAA8B,CAAC;AAEzD,SAASC,sBAAsBA,CAACC,aAAkC,EAAE;EAClE,OAAOC,KAAK,CAACC,IAAI,CAAC,CAAAF,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEG,UAAU,KAAI,EAAE,CAAC,CAACC,IAAI,CAAEC,EAAE,IAAK,CAACA,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAkBC,eAAe,MAAK,OAAO,CAAC;AACnH;AAEA,SAASC,YAAYA,CACnBC,YAAsC,EACtCC,MAA2B,EAC3BC,SAAiB,EACjBC,aAAmC,EACnCC,cAA+B,EAC/BC,GAAoB,EACpB;EAAA,IAAAC,qBAAA;EACA,IAAId,aAAa,GAAGS,MAAM;;EAE1B;EACA,IAAI,CAACT,aAAa,CAACe,WAAW,EAAE;IAAA,IAAAC,qBAAA,EAAAC,sBAAA;IAC9B,MAAMC,cAAc,GAAGV,YAAY,CAACW,aAAa,CAAE,gCAA+BV,MAAM,CAACW,YAAY,CAAC,SAAS,CAAE,IAAG,CAAwB;IAE5I,MAAMC,iBAAiB,IAAAL,qBAAA,GAAGjB,sBAAsB,CAACmB,cAAc,CAAC,cAAAF,qBAAA,uBAAtCA,qBAAA,CAAwCI,YAAY,CAAC,UAAU,CAAC;IAC1F,MAAME,gBAAgB,IAAAL,sBAAA,GAAGlB,sBAAsB,CAACC,aAAa,CAAC,cAAAiB,sBAAA,uBAArCA,sBAAA,CAAuCG,YAAY,CAAC,UAAU,CAAC;IACxF,IAAIC,iBAAiB,IAAIC,gBAAgB,IAAID,iBAAiB,KAAKC,gBAAgB,EAAE;MACnFtB,aAAa,GAAGkB,cAAc;IAChC,CAAC,MAAM;MACL,OAAO,CAAC;IACV;EACF;;EAEA;EACA,MAAMK,cAAc,GAAGf,YAAY,CAACW,aAAa,CAAE,mCAAkCT,SAAU,IAAG,CAAC;;EAEnG;EACA,IAAIa,cAAc,EAAE;IAClBA,cAAc,CAACC,MAAM,CAAC,CAAC;EACzB;EAEA,MAAMC,GAAG,GAAGb,cAAc,CAACc,UAA8B;EACzD,MAAM;IAACC,SAAS;IAAEC,QAAQ;IAAEC,SAAS;IAAEC,QAAQ;IAAEC;EAAY,CAAC,GAAGpB,aAAa,CAACqB,WAAW,IAAI,CAAC,CAAC;EAChG,MAAMC,QAAQ,GAAG;IACfN,SAAS;IACTC,QAAQ;IACRC,SAAS;IACTC,QAAQ;IACRC;EACF,CAAC;;EAED;EACAG,MAAM,CAACC,MAAM,CAACvB,cAAc,CAACwB,KAAK,EAAE;IAClC,GAAG3C,wBAAwB;IAC3B,IAAIoB,GAAG,IAAI;MACT,GAAGoB,QAAQ;MACXI,OAAO,EAAE,MAAM;MACfC,UAAU,EAAE,QAAQ;MACpBC,cAAc,EAAE;IAClB,CAAC;EACH,CAAC,CAAC;EACFL,MAAM,CAACC,MAAM,CAACV,GAAG,CAACW,KAAK,EAAE,CAACvB,GAAG,IAAIoB,QAAQ,CAAC;EAE1CjC,aAAa,CAACwC,WAAW,CAAC5B,cAAc,CAAC;EAEzC,MAAM6B,mBAAmB,GAAGjC,YAAY;EACxC,IAAIA,YAAY,CAACkC,aAAa,EAAE;IAC9BD,mBAAmB,CAACC,aAAa,CAACC,IAAI,CAAClB,GAAG,CAAC;EAC7C,CAAC,MAAM;IACLgB,mBAAmB,CAACC,aAAa,GAAG,CAACjB,GAAG,CAAC;EAC3C;EAEA,MAAMmB,iBAAiB,GAAGC,IAAI,CAACC,GAAG,CAACrB,GAAG,CAACsB,YAAY,EAAEnC,cAAc,CAACmC,YAAY,CAAC;EACjFb,MAAM,CAACC,MAAM,CAACvB,cAAc,CAACwB,KAAK,EAAE;IAClCY,MAAM,EAAG,GAAEJ,iBAAkB;EAC/B,CAAC,CAAC;EACF;EACA,MAAMK,cAAc,GAAG,IAAAC,uCAA2B,EAAE,IAAApC,qBAAA,GAAEH,aAAa,CAACqB,WAAW,cAAAlB,qBAAA,uBAAzBA,qBAAA,CAA2BqC,SAAU,EAAC,CAAC;EAC7FjB,MAAM,CAACC,MAAM,CAACnC,aAAa,CAACoC,KAAK,EAAE;IACjCgB,aAAa,EAAG,GAAER,iBAAiB,GAAGK,cAAe;EACvD,CAAC,CAAC;AACJ;AAEA,SAASI,kBAAkBA,CAAC7C,YAAsC,EAAE8C,UAAoB,EAAEC,GAAW,EAAE5C,aAAmC,EAAE;EAC1I,IAAId,UAAU,CAAC2D,GAAG,CAACF,UAAU,CAACG,UAAU,CAAC,EAAE;IACzC,MAAMC,OAAO,GAAG7D,UAAU,CAAC8D,GAAG,CAACL,UAAU,CAACG,UAAU,CAAC;IACrD;IACA,MAAMvC,cAAc,GAAGV,YAAY,CAACW,aAAa,CAAE,gCAA+BmC,UAAU,CAACG,UAAW,IAAG,CAAwB;IACnI,IAAI,CAAAC,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEH,GAAG,MAAKA,GAAG,IAAIrC,cAAc,IAAInB,sBAAsB,CAACmB,cAAc,CAAC,EAAE;MACpF;IACF;IAEA0C,YAAY,CAACF,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,OAAO,CAAC;IAC9BhE,UAAU,CAACiE,MAAM,CAACR,UAAU,CAACG,UAAU,CAAC;EAC1C;EAEA,MAAMI,OAAO,GAAGE,UAAU,CAAC,MAAM;IAC/B,MAAMnD,cAAc,GAAGoD,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;IACrDrD,cAAc,CAACN,eAAe,GAAG,OAAO;IACxCM,cAAc,CAACsD,YAAY,CAAC,WAAW,EAAE,kBAAkB,CAAC;IAE5D,MAAMzC,GAAG,GAAG,IAAI0C,KAAK,CAAC,CAAC;IACvBvD,cAAc,CAAC4B,WAAW,CAACf,GAAG,CAAC;IAE/BA,GAAG,CAACnB,eAAe,GAAG,OAAO;IAC7BmB,GAAG,CAAC2C,MAAM,GAAG,MAAM7D,YAAY,CAACC,YAAY,EAAE8C,UAAU,CAACe,OAAO,EAAEd,GAAG,EAAE5C,aAAa,EAAEC,cAAc,CAAC;IACrGa,GAAG,CAAC6C,OAAO,GAAIzD,GAAG,IAAKN,YAAY,CAACC,YAAY,EAAE8C,UAAU,CAACe,OAAO,EAAEd,GAAG,EAAE5C,aAAa,EAAEC,cAAc,EAAEC,GAAG,CAAC;IAC9GY,GAAG,CAAC8C,GAAG,GAAGhB,GAAG;IACb1D,UAAU,CAACiE,MAAM,CAACR,UAAU,CAACG,UAAU,CAAC;EAC1C,CAAC,EAAEjE,qCAAqC,CAAC;EACzCK,UAAU,CAAC2E,GAAG,CAAClB,UAAU,CAACG,UAAU,EAAE;IACpCI,OAAO;IACPN;EACF,CAAC,CAAC;AACJ;;AAEA;AACA,SAASkB,mBAAmBA,CAACnB,UAAoB,EAAEoB,UAA+B,EAAEzB,cAAc,GAAG,CAAC,EAAE;EACtG,MAAMG,aAAa,GAAI,GAAE,IAAAF,uCAA2B,EAACwB,UAAU,CAACtC,KAAK,CAACY,MAAM,CAAC,GAAGC,cAAe,IAAG;EAClGK,UAAU,CAACe,OAAO,CAAC7B,WAAW,CAACkC,UAAU,CAACC,SAAS,CAAC,IAAI,CAAC,CAAC;EAE1D,IAAIC,aAAa,GAAGtB,UAAU,CAACe,OAAO;EACtC,OAAOO,aAAa,CAACC,aAAa,IAAI,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,CAACC,QAAQ,CAACF,aAAa,CAACxD,YAAY,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE;IAChHwD,aAAa,GAAGA,aAAa,CAACC,aAAoC;EACpE;EACA3C,MAAM,CAACC,MAAM,CAACyC,aAAa,CAACxC,KAAK,EAAE;IACjCgB;EACF,CAAC,CAAC;EAEF,OAAOE,UAAU;AACnB;;AAEA;AACA,SAASyB,qBAAqBA,CAC5BvE,YAAsC,EACtC8C,UAAoB,EACpB0B,IAAY,EACZC,MAAuB,EACvBtE,aAAmC,EACnCuE,iBAAyC,EACzC;EAAA,IAAAC,sBAAA,EAAAC,sBAAA,EAAAC,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA;EACA,MAAM;IAACC,8BAA8B;IAAEC;EAA4B,CAAC,GAAGP,iBAAiB;EACxF,MAAMQ,SAAS,GAAGT,MAAM,CAAC7E,IAAI,CAAEuF,CAAC,IAAKA,CAAC,CAACC,IAAI,KAAK,MAAM,CAAC;EACvD,IAAIlF,SAAS,GAAG,EAAE;EAClB,IAAIgF,SAAS,EAAE;IACbhF,SAAS,GAAGsE,IAAI,CAACa,SAAS,CAACH,SAAS,CAACI,KAAK,EAAEJ,SAAS,CAACI,KAAK,GAAGJ,SAAS,CAACK,MAAM,CAAC;IAC/E,IAAIP,8BAA8B,IAAIC,4BAA4B,IAAIA,4BAA4B,CAACrF,IAAI,CAAEmD,GAAG,IAAK7C,SAAS,CAACsF,UAAU,CAACzC,GAAG,CAAC,CAAC,EAAE;MAC3I7C,SAAS,GAAG8E,8BAA8B,CAAC9E,SAAS,CAAC;IACvD;EACF;EAEA,MAAMuC,cAAc,GAAG,IAAAC,uCAA2B,EAAE,IAAAiC,sBAAA,GAAExE,aAAa,CAACqB,WAAW,cAAAmD,sBAAA,uBAAzBA,sBAAA,CAA2BhC,SAAU,EAAC,CAAC;EAC7F,MAAM8C,iBAAiB,GAAG,IAAA/C,uCAA2B,EAAE,IAAAkC,sBAAA,GAAEzE,aAAa,CAACqB,WAAW,cAAAoD,sBAAA,uBAAzBA,sBAAA,CAA2Bc,YAAa,EAAC,CAAC;;EAEnG;EACA;EACA,MAAMC,oBAAoB,IAAAd,qBAAA,GAAG7E,YAAY,CAACkC,aAAa,cAAA2C,qBAAA,uBAA1BA,qBAAA,CAA4BjF,IAAI,CAAEC,EAAE,IAAK,CAAAA,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEkE,GAAG,MAAK7D,SAAS,CAAC;EAC5F,MAAM0F,oBAAoB,GAAGD,oBAAoB,aAApBA,oBAAoB,uBAApBA,oBAAoB,CAAEtB,aAAa;EAEhE,IAAIuB,oBAAoB,IAAIA,oBAAoB,CAAChF,YAAY,CAAC,WAAW,CAAC,KAAK,kBAAkB,EAAE;IACjG,OAAOqD,mBAAmB,CAACnB,UAAU,EAAE8C,oBAAoB,EAAyBnD,cAAc,CAAC;EACrG;;EAEA;EACA,MAAMoD,OAAO,GAAG,IAAAC,wCAAsB,EAAC5F,SAAS,EAAEC,aAAa,CAAC;EAChE,IAAI0F,OAAO,EAAE;IACX/C,UAAU,CAACe,OAAO,CAAC7B,WAAW,CAAC6D,OAAO,CAAC;EACzC;EAEAnE,MAAM,CAACC,MAAM,CAACmB,UAAU,CAACe,OAAO,CAACjC,KAAK,EAAE;IACtCC,OAAO,EAAE,OAAO;IAChB6D,YAAY,EAAG,GAAED,iBAAkB,IAAG;IACtC7C,aAAa,EAAE,EAAAkC,qBAAA,GAAA3E,aAAa,CAAC4F,yBAAyB,cAAAjB,qBAAA,uBAAvCA,qBAAA,CAAyCtC,MAAM,OAAAuC,sBAAA,GAAI5E,aAAa,CAAC6F,gBAAgB,cAAAjB,sBAAA,uBAA9BA,sBAAA,CAAgCvC,MAAM,KAAK,CAAC,CAACrC,aAAa,CAAC6F,gBAAgB,IAAI,MAAO,IAAIC;EAC9J,CAAC,CAAC;EAEFpD,kBAAkB,CAAC7C,YAAY,EAAE8C,UAAU,EAAE5C,SAAS,EAAEC,aAAa,CAAC;EAEtE,OAAO2C,UAAU;AACnB;AAEA,SAASoD,qBAAqBA,CAAClG,YAAsC,EAAEG,aAAmC,EAAE;EAC1GH,YAAY,CAACmG,gBAAgB,CAAC,KAAK,CAAC,CAACC,OAAO,CAAEnF,GAAG,IAAK;IACpD;IACA,IAAIA,GAAG,CAACoF,YAAY,GAAG,CAAC,EAAE;MACxB;IACF;IAEA,MAAMtD,GAAG,GAAG9B,GAAG,CAAC8C,GAAG;IACnB,MAAMuC,UAAU,GAAGrF,GAAG;IACtBqF,UAAU,CAACvC,GAAG,GAAG,EAAE;IACnBuC,UAAU,CAAC1C,MAAM,GAAG;MAAA,IAAA2C,kBAAA;MAAA,OAAMxG,YAAY,CAACC,YAAY,GAAAuG,kBAAA,GAAEtF,GAAG,CAACoD,aAAa,cAAAkC,kBAAA,uBAAjBA,kBAAA,CAAmBlC,aAAa,EAAyBtB,GAAG,EAAE5C,aAAa,EAAEc,GAAG,CAACoD,aAAoC,CAAC;IAAA;IAC3KiC,UAAU,CAACvC,GAAG,GAAI,GAAEhB,GAAI,GAAE;EAC5B,CAAC,CAAC;AACJ;;AAEA"}