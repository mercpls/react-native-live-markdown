{"version":3,"names":["parseStringWithUnitToNumber","createLoadingIndicator","INLINE_IMAGE_PREVIEW_DEBOUNCE_TIME_MS","inlineImageDefaultStyles","position","bottom","left","timeoutMap","Map","getImagePreviewElement","targetElement","Array","from","childNodes","find","el","contentEditable","handleOnLoad","currentInput","target","imageHref","markdownStyle","imageContainer","err","_markdownStyle$inline","isConnected","_getImagePreviewEleme","_getImagePreviewEleme2","currentElement","querySelector","getAttribute","currentElementURL","targetElementURL","currentSpinner","remove","img","firstChild","minHeight","minWidth","maxHeight","maxWidth","borderRadius","inlineImage","imgStyle","Object","assign","style","display","alignItems","justifyContent","appendChild","currentInputElement","imageElements","push","imageClientHeight","Math","max","clientHeight","height","imageMarginTop","marginTop","paddingBottom","createImageElement","targetNode","url","has","orderIndex","mapItem","get","clearTimeout","timeout","delete","setTimeout","document","createElement","setAttribute","Image","onload","element","onerror","src","set","updateImageTreeNode","newElement","cloneNode","currentParent","parentElement","includes","addInlineImagePreview","text","ranges","inlineImagesProps","_markdownStyle$inline2","_markdownStyle$inline3","_currentInput$imageEl","_markdownStyle$loadin","_markdownStyle$loadin2","addAuthTokenToImageURLCallback","imagePreviewAuthRequiredURLs","linkRange","r","type","substring","start","length","startsWith","imageMarginBottom","marginBottom","alreadyLoadedPreview","loadedImageContainer","spinner","loadingIndicatorContainer","loadingIndicator","undefined","forceRefreshAllImages","querySelectorAll","forEach","naturalWidth","imgElement","_img$parentElement"],"sourceRoot":"../../../../src","sources":["web/inputElements/inlineImage.ts"],"mappings":"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"}